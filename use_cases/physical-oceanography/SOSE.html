<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SOSE Heat and Salt Budgets &#8212; Pangeo  documentation</title>
    <link rel="stylesheet" href="../../_static/pangeo-style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/example_gallery_styles.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/example_gallery_styles_patched.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Climate modeling" href="../climate-modeling/index.html" />
    <link rel="prev" title="Sea Surface Altimetry Data Analysis" href="sea-surface-height.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
            <span><img src="../../_static/small_e_reversed_24px.png"></span>
          Pangeo</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://medium.com/pangeo">Blog</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About Pangeo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#mission-statement">Mission Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#goals">Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#get-involved">Get Involved</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../quickstart.html">Guide for Scientists</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#learn-about-pangeo-software">Learn About Pangeo Software</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../quickstart.html#explore-the-use-cases">Explore the Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#try-out-a-pangeo-deployment">Try Out a Pangeo Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#give-feedback">Give Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#contribute-a-use-case">Contribute a Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#contribute-data">Contribute Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#become-an-open-source-contributor">Become an Open Source Contributor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../packages.html">Packages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../packages.html#pangeo-core-packages">Pangeo Core Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages.html#pangeo-affiliated-packages">Pangeo Affiliated Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../packages.html#guidelines-for-new-packages">Guidelines for New Packages</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Geoscience Use Cases</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Physical Oceanography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../climate-modeling/index.html">Climate modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../meteorology/index.html">Meteorology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">Technical Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#where-we-began">Where we began</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#interoperability-in-pangeo">Interoperability in Pangeo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#compute-platforms">Compute Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../architecture.html#storage-formats">Storage Formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../setup_guides/index.html">Deployment Setup Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../setup_guides/index.html#setting-up-pangeo-on-hpc-systems">Setting up Pangeo on HPC Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../setup_guides/index.html#setting-up-pangeo-on-cloud-systems">Setting up Pangeo on Cloud Systems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../deployments.html">Deployments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../deployments.html#pangeo-provided-cloud-deployments">Pangeo provided Cloud Deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deployments.html#other-cloud-deployments">Other Cloud deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deployments.html#high-performance-computing-deployments">High Performance Computing Deployments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html">Pangeo and Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#data-on-hpc">Data on HPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data.html#data-in-the-cloud">Data in the Cloud</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../catalog.html">Pangeo Data Catalog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../collaborators.html">Collaborators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../collaborators.html#funding-agencies">Funding Agencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../collaborators.html#institutions">Institutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../collaborators.html#people">People</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../meeting-notes.html">Pangeo Weekly Meeting Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../meeting-notes.html#meeting-calendar">Meeting Calendar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../meeting-notes.html#id1">Meeting Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../meetings/index.html">Pangeo Conferences</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../meetings/index.html#future-meetings">Future Meetings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../meetings/index.html#past-meetings">Past Meetings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact Pangeo</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">SOSE Heat and Salt Budgets</a><ul>
<li><a class="reference internal" href="#connect-to-dask-cluster">Connect to Dask Cluster</a></li>
<li><a class="reference internal" href="#open-sose-dataset-from-cloud-storage">Open SOSE Dataset from Cloud Storage</a></li>
<li><a class="reference internal" href="#visualize-some-data">Visualize Some Data</a></li>
<li><a class="reference internal" href="#create-xgcm-grid">Create xgcm grid</a></li>
<li><a class="reference internal" href="#tracer-budgets">Tracer Budgets</a><ul>
<li><a class="reference internal" href="#flux-divergence">Flux Divergence</a></li>
<li><a class="reference internal" href="#surface-fluxes">Surface Fluxes</a></li>
<li><a class="reference internal" href="#shortwave-flux">Shortwave Flux</a></li>
<li><a class="reference internal" href="#add-it-all-up">Add it all up</a></li>
<li><a class="reference internal" href="#include-the-truth">Include the “truth”</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validate-budget">Validate Budget</a><ul>
<li><a class="reference internal" href="#vertical-and-horizontal-integrals-of-budget">Vertical and Horizontal Integrals of Budget</a></li>
<li><a class="reference internal" href="#histogram-analysis-of-error">Histogram Analysis of Error</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weddell-sea-budget-timeseries">Weddell Sea Budget Timeseries</a><ul>
<li><a class="reference internal" href="#removing-climatlogy">Removing Climatlogy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="sea-surface-height.html" title="Previous Chapter: Sea Surface Altimetry Data Analysis"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Sea Surface A...</span>
    </a>
  </li>
  <li>
    <a href="../climate-modeling/index.html" title="Next Chapter: Climate modeling"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Climate modeling &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
            
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">SOSE Heat and Salt Budgets</a><ul>
<li><a class="reference internal" href="#connect-to-dask-cluster">Connect to Dask Cluster</a></li>
<li><a class="reference internal" href="#open-sose-dataset-from-cloud-storage">Open SOSE Dataset from Cloud Storage</a></li>
<li><a class="reference internal" href="#visualize-some-data">Visualize Some Data</a></li>
<li><a class="reference internal" href="#create-xgcm-grid">Create xgcm grid</a></li>
<li><a class="reference internal" href="#tracer-budgets">Tracer Budgets</a><ul>
<li><a class="reference internal" href="#flux-divergence">Flux Divergence</a></li>
<li><a class="reference internal" href="#surface-fluxes">Surface Fluxes</a></li>
<li><a class="reference internal" href="#shortwave-flux">Shortwave Flux</a></li>
<li><a class="reference internal" href="#add-it-all-up">Add it all up</a></li>
<li><a class="reference internal" href="#include-the-truth">Include the “truth”</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validate-budget">Validate Budget</a><ul>
<li><a class="reference internal" href="#vertical-and-horizontal-integrals-of-budget">Vertical and Horizontal Integrals of Budget</a></li>
<li><a class="reference internal" href="#histogram-analysis-of-error">Histogram Analysis of Error</a></li>
</ul>
</li>
<li><a class="reference internal" href="#weddell-sea-budget-timeseries">Weddell Sea Budget Timeseries</a><ul>
<li><a class="reference internal" href="#removing-climatlogy">Removing Climatlogy</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content ">
      
  <div class="section" id="sose-heat-and-salt-budgets">
<span id="gallery-use-cases-physical-oceanography-sose-ipynb"></span><h1>SOSE Heat and Salt Budgets<a class="headerlink" href="#sose-heat-and-salt-budgets" title="Permalink to this headline">¶</a></h1>
<p>Evaluating the conservation of heat and salt content in the Southern
Ocean State Estimate</p>
<p>Author: <a class="reference external" href="http://github.com/rabernat">Ryan Abernathey</a></p>
<div class="figure" id="id1">
<img alt="SOSE Logo" src="http://sose.ucsd.edu/images/SOSEpic.png" />
<p class="caption"><span class="caption-text">SOSE Logo</span></p>
</div>
<div class="section" id="connect-to-dask-cluster">
<h2>Connect to Dask Cluster<a class="headerlink" href="#connect-to-dask-cluster" title="Permalink to this headline">¶</a></h2>
<p>Below we create a dask cluster with 30 nodes to do our work for us.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="k">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">progress</span>
<span class="kn">from</span> <span class="nn">dask_kubernetes</span> <span class="k">import</span> <span class="n">KubeCluster</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">KubeCluster</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">cluster</span>
</pre></div>
</div>
<pre class="literal-block">
VBox(children=(HTML(value='&lt;h2&gt;KubeCluster&lt;/h2&gt;'), HBox(children=(HTML(value='n&lt;div&gt;n  &lt;style scoped&gt;n    .…
</pre>
<p>** ☝️ don’t forget to follow along on the dashboard **</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
<span class="n">client</span>
</pre></div>
</div>
<table style="border: 2px solid white;">
<tr>
<td style="vertical-align: top; border: 0px solid white">
<h3>Client</h3>
<ul>
  <li><b>Scheduler: </b>tcp://10.23.98.244:41724
  <li><b>Dashboard: </b><a href='/user/rabernat/proxy/8787/status' target='_blank'>/user/rabernat/proxy/8787/status</a>
</ul>
</td>
<td style="vertical-align: top; border: 0px solid white">
<h3>Cluster</h3>
<ul>
  <li><b>Workers: </b>0</li>
  <li><b>Cores: </b>0</li>
  <li><b>Memory: </b>0 B</li>
</ul>
</td>
</tr>
</table><p>Import necessary Python packages</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">gcsfs</span>
<span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">dsa</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="section" id="open-sose-dataset-from-cloud-storage">
<h2>Open SOSE Dataset from Cloud Storage<a class="headerlink" href="#open-sose-dataset-from-cloud-storage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="n">gcsfs</span><span class="o">.</span><span class="n">GCSMap</span><span class="p">(</span><span class="s1">&#39;pangeo-data/SOSE&#39;</span><span class="p">))</span>
<span class="n">ds</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>   <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">XG</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">YG</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">Zl</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">Zp1</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="n">Zu</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
    <span class="n">Depth</span>     <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">PHrefC</span>    <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">PHrefF</span>    <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,)</span><span class="o">&gt;</span>
  <span class="o">*</span> <span class="n">XC</span>        <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="mf">0.5833334</span> <span class="mf">0.75</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XG</span>        <span class="p">(</span><span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">5.551115e-17</span> <span class="mf">0.16666667</span> <span class="mf">0.33333334</span> <span class="mf">0.5</span> <span class="mf">0.6666667</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>        <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">-</span><span class="mf">77.37497</span> <span class="o">-</span><span class="mf">77.2083</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YG</span>        <span class="p">(</span><span class="n">YG</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.9583</span> <span class="o">-</span><span class="mf">77.79163</span> <span class="o">-</span><span class="mf">77.62497</span> <span class="o">-</span><span class="mf">77.4583</span> <span class="o">-</span><span class="mf">77.29163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Z</span>         <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">-</span><span class="mf">85.0</span> <span class="o">-</span><span class="mf">104.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zl</span>        <span class="p">(</span><span class="n">Zl</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zp1</span>       <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zu</span>        <span class="p">(</span><span class="n">Zu</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">-</span><span class="mf">114.0</span> <span class="o">...</span>
    <span class="n">drC</span>       <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">drF</span>       <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">dxC</span>       <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">dxG</span>       <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">dyC</span>       <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">dyG</span>       <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">hFacC</span>     <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">hFacS</span>     <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">hFacW</span>     <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="nb">iter</span>      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">int64</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">rA</span>        <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">rAs</span>       <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">rAw</span>       <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">rAz</span>       <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="o">*</span> <span class="n">time</span>      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">16</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">ADVr_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVr_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVx_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVx_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVy_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVy_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrE_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrE_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrI_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrI_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFxE_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFxE_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFyE_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFyE_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DRHODR</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ETAN</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">EXFswnet</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">KPPg_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">KPPg_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">PHIHYD</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SALT</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SFLUX</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIarea</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIatmFW</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIatmQnt</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdHbATC</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdHbATO</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdHbOCN</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdSbATC</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdSbOCN</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIempmr</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIfu</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIfv</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIheff</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIhsnow</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIsnPrcp</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SItflux</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIuheff</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIuice</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIvheff</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIvice</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">TFLUX</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">THETA</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">TOTSTEND</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">TOTTTEND</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">UVEL</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">VVEL</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">WSLTMASS</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">WTHMASS</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">WVEL</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceFreez</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceQsw</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceTAUX</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceTAUY</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surForcS</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surForcT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total Size: </span><span class="si">%6.2F</span><span class="s1"> GB&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">Size</span><span class="p">:</span> <span class="mf">1408.75</span> <span class="n">GB</span>
</pre></div>
</div>
<p>A trick for optimization: split the dataset into coordinates and data
variables, and then drop the coordinates from the data variables. This
makes it easier to align the data variables in arithmetic operations.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">coords</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">()</span>
<span class="n">dsr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dsr</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>   <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">XG</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">YG</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">Zl</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">Zp1</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="n">Zu</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">XC</span>        <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="mf">0.5833334</span> <span class="mf">0.75</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XG</span>        <span class="p">(</span><span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">5.551115e-17</span> <span class="mf">0.16666667</span> <span class="mf">0.33333334</span> <span class="mf">0.5</span> <span class="mf">0.6666667</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>        <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">-</span><span class="mf">77.37497</span> <span class="o">-</span><span class="mf">77.2083</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YG</span>        <span class="p">(</span><span class="n">YG</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.9583</span> <span class="o">-</span><span class="mf">77.79163</span> <span class="o">-</span><span class="mf">77.62497</span> <span class="o">-</span><span class="mf">77.4583</span> <span class="o">-</span><span class="mf">77.29163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Z</span>         <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">-</span><span class="mf">85.0</span> <span class="o">-</span><span class="mf">104.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zl</span>        <span class="p">(</span><span class="n">Zl</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zp1</span>       <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zu</span>        <span class="p">(</span><span class="n">Zu</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">-</span><span class="mf">114.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">time</span>      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">16</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">ADVr_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVr_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVx_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVx_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVy_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ADVy_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrE_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrE_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrI_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFrI_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFxE_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFxE_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFyE_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DFyE_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">DRHODR</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">ETAN</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">EXFswnet</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">KPPg_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">KPPg_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">PHIHYD</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SALT</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SFLUX</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIarea</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIatmFW</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIatmQnt</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdHbATC</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdHbATO</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdHbOCN</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdSbATC</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIdSbOCN</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIempmr</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIfu</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIfv</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIheff</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIhsnow</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIsnPrcp</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SItflux</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIuheff</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIuice</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIvheff</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">SIvice</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">TFLUX</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">THETA</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">TOTSTEND</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">TOTTTEND</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">UVEL</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">VVEL</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">WSLTMASS</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">WTHMASS</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">WVEL</span>      <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Zl</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceFreez</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceQsw</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceTAUX</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">oceTAUY</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surForcS</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surForcT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">coords</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>  <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">XG</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">YG</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">Zl</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">Zp1</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="n">Zu</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">Zp1</span>      <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zu</span>       <span class="p">(</span><span class="n">Zu</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">-</span><span class="mf">114.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>       <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">-</span><span class="mf">77.37497</span> <span class="o">-</span><span class="mf">77.2083</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>       <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="mf">0.5833334</span> <span class="mf">0.75</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Z</span>        <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">-</span><span class="mf">85.0</span> <span class="o">-</span><span class="mf">104.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YG</span>       <span class="p">(</span><span class="n">YG</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.9583</span> <span class="o">-</span><span class="mf">77.79163</span> <span class="o">-</span><span class="mf">77.62497</span> <span class="o">-</span><span class="mf">77.4583</span> <span class="o">-</span><span class="mf">77.29163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">time</span>     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">16</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XG</span>       <span class="p">(</span><span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">5.551115e-17</span> <span class="mf">0.16666667</span> <span class="mf">0.33333334</span> <span class="mf">0.5</span> <span class="mf">0.6666667</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Zl</span>       <span class="p">(</span><span class="n">Zl</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span><span class="mf">21.0</span> <span class="o">-</span><span class="mf">33.0</span> <span class="o">-</span><span class="mf">46.0</span> <span class="o">-</span><span class="mf">60.0</span> <span class="o">-</span><span class="mf">76.0</span> <span class="o">-</span><span class="mf">94.0</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">dxC</span>      <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">dyC</span>      <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">drF</span>      <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">dyG</span>      <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">hFacS</span>    <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="nb">iter</span>     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">int64</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">rAz</span>      <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">rAw</span>      <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">dxG</span>      <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">rAs</span>      <span class="p">(</span><span class="n">YG</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">PHrefC</span>   <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">hFacC</span>    <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">Depth</span>    <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">hFacW</span>    <span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XG</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">PHrefF</span>   <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,)</span><span class="o">&gt;</span>
    <span class="n">rA</span>       <span class="p">(</span><span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">drC</span>      <span class="p">(</span><span class="n">Zp1</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">43</span><span class="p">,)</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="visualize-some-data">
<h2>Visualize Some Data<a class="headerlink" href="#visualize-some-data" title="Permalink to this headline">¶</a></h2>
<p>As a sanity check, let’s look at some values.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">holoviews</span> <span class="k">as</span> <span class="nn">hv</span>
<span class="kn">from</span> <span class="nn">holoviews.operation.datashader</span> <span class="k">import</span> <span class="n">regrid</span>
<span class="n">hv</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;bokeh&#39;</span><span class="p">)</span>
</pre></div>
</div>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<style>div.hololayout {
  display: flex;
  align-items: center;
  margin: 0;
}

div.holoframe {
  width: 75%;
}

div.holowell {
  display: flex;
  align-items: center;
}

form.holoform {
  background-color: #fafafa;
  border-radius: 5px;
  overflow: hidden;
  padding-left: 0.8em;
  padding-right: 0.8em;
  padding-top: 0.4em;
  padding-bottom: 0.4em;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  margin-bottom: 20px;
  border: 1px solid #e3e3e3;
}

div.holowidgets {
  padding-right: 0;
  width: 25%;
}

div.holoslider {
  min-height: 0 !important;
  height: 0.8em;
  width: 100%;
}

div.holoformgroup {
  padding-top: 0.5em;
  margin-bottom: 0.5em;
}

div.hologroup {
  padding-left: 0;
  padding-right: 0.8em;
  width: 100%;
}

.holoselect {
  width: 92%;
  margin-left: 0;
  margin-right: 0;
}

.holotext {
  padding-left:  0.5em;
  padding-right: 0;
  width: 100%;
}

.holowidgets .ui-resizable-se {
  visibility: hidden
}

.holoframe > .ui-resizable-se {
  visibility: hidden
}

.holowidgets .ui-resizable-s {
  visibility: hidden
}


/* CSS rules for noUISlider based slider used by JupyterLab extension  */

.noUi-handle {
  width: 20px !important;
  height: 20px !important;
  left: -5px !important;
  top: -5px !important;
}

.noUi-handle:before, .noUi-handle:after {
  visibility: hidden;
  height: 0px;
}

.noUi-target {
  margin-left: 0.5em;
  margin-right: 0.5em;
}

div.bk-hbox {
    display: flex;
    justify-content: center;
}

div.bk-hbox div.bk-plot {
    padding: 8px;
}

div.bk-hbox div.bk-data-table {
    padding: 20px;
}
</style>


<div class="logo-block">
<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAAB+wAAAfsBxc2miwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA6zSURB
VHic7ZtpeFRVmsf/5966taWqUlUJ2UioBBJiIBAwCZtog9IOgjqACsogKtqirT2ttt069nQ/zDzt
tI4+CrJIREFaFgWhBXpUNhHZQoKBkIUASchWla1S+3ar7r1nPkDaCAnZKoQP/D7mnPOe9/xy76n3
nFSAW9ziFoPFNED2LLK5wcyBDObkb8ZkxuaoSYlI6ZcOKq1eWFdedqNzGHQBk9RMEwFAASkk0Xw3
ETacDNi2vtvc7L0ROdw0AjoSotQVkKSvHQz/wRO1lScGModBFbDMaNRN1A4tUBCS3lk7BWhQkgpD
lG4852/+7DWr1R3uHAZVQDsbh6ZPN7CyxUrCzJMRouusj0ipRwD2uKm0Zn5d2dFwzX1TCGhnmdGo
G62Nna+isiUqhkzuKrkQaJlPEv5mFl2fvGg2t/VnzkEV8F5ioioOEWkLG86fvbpthynjdhXYZziQ
x1hC9J2NFyi8vCTt91Fh04KGip0AaG9zuCk2wQCVyoNU3Hjezee9bq92duzzTmxsRJoy+jEZZZYo
GTKJ6SJngdJqAfRzpze0+jHreUtPc7gpBLQnIYK6BYp/uGhw9YK688eu7v95ysgshcg9qSLMo3JC
4jqLKQFBgdKDPoQ+Pltb8dUyQLpeDjeVgI6EgLIQFT5tEl3rn2losHVsexbZ3EyT9wE1uGdkIPcy
BGxn8QUq1QrA5nqW5i2tLqvrrM9NK6AdkVIvL9E9bZL/oyfMVd/jqvc8LylzRBKDJSzIExwhQzuL
QYGQj4rHfFTc8mUdu3E7yoLtbTe9gI4EqVgVkug2i5+uXGo919ixbRog+3fTbQ8qJe4ZOYNfMoTI
OoshUNosgO60AisX15aeI2PSIp5KiFLI9ubb1vV3Qb2ltwLakUCDAkWX7/nHKRmmGIl9VgYsUhJm
2NXjKYADtM1ygne9QQDIXlk49FBstMKx66D1v4+XuQr7vqTe0VcBHQlRWiOCbmmSYe2SqtL6q5rJ
zsTb7lKx3FKOYC4DoqyS/B5bvLPxvD9Qtf6saxYLQGJErmDOdOMr/zo96km1nElr8bmPOBwI9COv
HnFPRIwmkSOv9kcAS4heRsidOkpeWBgZM+UBrTFAXNYL5Vf2ii9c1trNzpYdaoVil3WIc+wdk+gQ
noie3ecCcxt9ITcLAPWt/laGEO/9U6PmzZkenTtsSMQ8uYywJVW+grCstAvCIaAdArAsIWkRDDs/
KzLm2YcjY1Lv0UdW73HabE9n6V66cxSzfEmuJssTpKGVp+0vHq73FwL46eOjpMpbRAnNmJFrGJNu
Ukf9Yrz+3rghiumCKNXXWPhLYcjxGsIpoCMsIRoFITkW8AuyM8jC1+/QLx4bozCEJIq38+1rtpR6
V/yzb8eBlRb3fo5l783N0CWolAzJHaVNzkrTzlEp2bQ2q3TC5gn6wpnoQAmwSiGh2GitnTmVMc5O
UyfKWUKCIsU7+fZDKwqdT6DDpvkzAX4/+AMFjk0tDp5GRXLpQ2MUmhgDp5gxQT8+Y7hyPsMi8uxF
71H0oebujHALECjFKaW9Lm68n18wXp2kVzIcABytD5iXFzg+WVXkegpAsOOYziqo0OkK76GyquC3
ltZAzMhhqlSNmmWTE5T6e3IN05ITFLM4GdN0vtZ3ob8Jh1NAKXFbm5PtLU/eqTSlGjkNAJjdgn/N
aedXa0tdi7+t9G0FIF49rtMSEgAs1kDLkTPO7ebm4IUWeyh1bKomXqlgMG6kJmHcSM0clYLJ8XtR
1GTnbV3F6I5wCGikAb402npp1h1s7LQUZZSMIfALFOuL3UUrfnS8+rez7v9qcold5tilgHbO1fjK
9ubb17u9oshxzMiUBKXWqJNxd+fqb0tLVs4lILFnK71H0Ind7uiPgACVcFJlrb0tV6DzxqqTIhUM
CwDf1/rrVhTa33/3pGPxJYdQ2l2cbgVcQSosdx8uqnDtbGjh9SlDVSMNWhlnilfqZk42Th2ZpLpf
xrHec5e815zrr0dfBZSwzkZfqsv+1FS1KUknUwPARVvItfKUY+cn57yP7qv07UE3p8B2uhUwLk09
e0SCOrK+hbdYHYLjRIl71wWzv9jpEoeOHhGRrJAzyEyNiJuUqX0g2sBN5kGK6y2Blp5M3lsB9Qh4
y2Ja6x6+i0ucmKgwMATwhSjdUu49tKrQ/pvN5d53ml2CGwCmJipmKjgmyuaXzNeL2a0AkQ01Th5j
2DktO3Jyk8f9vcOBQHV94OK+fPumJmvQHxJoWkaKWq9Vs+yUsbq0zGT1I4RgeH2b5wef7+c7bl8F
eKgoHVVZa8ZPEORzR6sT1BzDUAD/d9F78e2Tzv99v8D+fLVTqAKAsbGamKey1Mt9Ann4eH3gTXTz
idWtAJ8PQWOk7NzSeQn/OTHDuEikVF1R4z8BQCy+6D1aWRfY0tTGG2OM8rRoPaeIj5ZHzJxszElN
VM8K8JS5WOfv8mzRnQAKoEhmt8gyPM4lU9SmBK1MCQBnW4KONT86v1hZ1PbwSXPw4JWussVjtH9Y
NCoiL9UoH/6PSu8jFrfY2t36erQHXLIEakMi1SydmzB31h3GGXFDFNPaK8Rme9B79Ixrd0WN+1ij
NRQ/doRmuFLBkHSTOm5GruG+pFjFdAmorG4IXH1Qua6ASniclfFtDYt+oUjKipPrCQB7QBQ2lrgP
fFzm+9XWUtcqJ3/5vDLDpJ79XHZk3u8nGZ42qlj1+ydtbxysCezrydp6ugmipNJ7WBPB5tydY0jP
HaVNzs3QzeE4ZpTbI+ZbnSFPbVOw9vsfnVvqWnirPyCNGD08IlqtYkh2hjZ5dErEQzoNm+6ykyOt
Lt5/PQEuSRRKo22VkydK+vvS1XEKlhCJAnsqvcVvH7f/ZU2R67eXbMEGAMiIV5oWZWiWvz5Fv2xG
sjqNJQRvn3Rs2lji/lNP19VjAQDgD7FHhujZB9OGqYxRkZxixgRDVlqS6uEOFaJUVu0rPFzctrnF
JqijImVp8dEKVWyUXDk92zAuMZ6bFwpBU1HrOw6AdhQgUooChb0+ItMbWJitSo5Ws3IAOGEOtL53
0vHZih9sC4vtofZ7Qu6523V/fmGcds1TY3V36pUsBwAbSlxnVh2xLfAD/IAIMDf7XYIkNmXfpp2l
18rkAJAy9HKFaIr/qULkeQQKy9zf1JgDB2uaeFNGijo5QsUyacNUUTOnGO42xSnv4oOwpDi1zYkc
efUc3I5Gk6PhyTuVKaOGyLUAYPGIoY9Pu/atL/L92+4q9wbflRJ2Trpm/jPjdBtfnqB/dIThcl8A
KG7hbRuKnb8qsQsVvVlTrwQAQMUlf3kwJI24Z4JhPMtcfng5GcH49GsrxJpGvvHIaeem2ma+KSjQ
lIwUdYyCY8j4dE1KzijNnIP2llF2wcXNnsoapw9XxsgYAl6k+KzUXbi2yP3KR2ecf6z3BFsBICdW
nvnIaG3eHybqX7vbpEqUMT+9OL4Qpe8VON7dXuFd39v19FoAABRVePbGGuXTszO0P7tu6lghUonE
llRdrhArLvmKdh9u29jcFiRRkfLUxBiFNiqSU9icoZQHo5mYBI1MBgBH6wMNb+U7Pnw337H4gi1Y
ciWs+uks3Z9fztUvfzxTm9Ne8XXkvQLHNytOOZeiD4e0PgkAIAYCYknKUNUDSXEKzdWNpnil7r4p
xqkjTarZMtk/K8TQ6Qve78qqvXurGwIJqcOUKfUWHsm8KGvxSP68YudXq4pcj39X49uOK2X142O0
Tz5/u/7TVybqH0rSya6ZBwD21/gubbrgWdDgEOx9WUhfBaC2ibcEBYm7a7x+ukrBMNcEZggyR0TE
T8zUPjikQ4VosQZbTpS4vqizBKvqmvjsqnpfzaZyx9JPiz1/bfGKdgD45XB1zoIMzYbfTdS/NClB
Gct0USiY3YL/g0LHy/uq/Ef6uo5+n0R/vyhp17Klpge763f8rMu6YU/zrn2nml+2WtH+Z+5IAAFc
2bUTdTDOSNa9+cQY7YLsOIXhevEkCvzph7a8laecz/Un/z4/Ae04XeL3UQb57IwU9ZDr9UuKVajv
nxp1+1UVIo/LjztZkKH59fO3G/JemqCfmaCRqbqbd90ZZ8FfjtkfAyD0J/9+C2h1hDwsSxvGjNDc
b4zk5NfrSwiQblLHzZhg+Jf4aPlUwpDqkQqa9nimbt1/TDH8OitGMaQnj+RJS6B1fbF7SY1TqO5v
/v0WAADl1f7zokgS7s7VT2DZ7pegUjBM7mjtiDZbcN4j0YrHH0rXpCtY0qPX0cVL0rv5jv/ZXend
0u/EESYBAFBU4T4Qa5TflZOhTe7pmKpaP8kCVUVw1+yhXfJWvn1P3hnXi33JsTN6PnP3hHZ8Z3/h
aLHzmkNPuPj7Bc/F/Q38CwjTpSwQXgE4Vmwry9tpfq/ZFgqFMy4AVDtCvi8rvMvOmv0N4YwbVgEA
sPM72/KVnzfspmH7HQGCRLG2yL1+z8XwvPcdCbsAANh+xPzstgMtxeGKt+6MK3/tacfvwhWvIwMi
oKEBtm0H7W+UVfkc/Y1V0BhoPlDr/w1w/eu1vjIgAgDg22OtX6/eYfnEz/focrZTHAFR+PSs56/7
q32nwpjazxgwAQCwcU/T62t3WL7r6/jVRa6/byp1rei+Z98ZUAEAhEPHPc8fKnTU9nbgtnOe8h0l
9hcGIqmODLQAHCy2Xti6v/XNRivf43f4fFvIteu854+VHnR7q9tfBlwAAGz+pnndB9vM26UebAe8
SLHujPOTPVW+rwY+sxskAAC2HrA8t2Vvc7ffP1r9o+vwR2dcr92InIAbKKC1FZ5tB1tf+/G8p8sv
N/9Q5zd/XR34LYCwV5JdccMEAMDBk45DH243r/X4xGvqxFa/GNpS7n6rwOwNWwHVE26oAADYurf1
zx/utOzt+DMKYM0p17YtZZ5VNzqfsB2HewG1WXE8PoZ7gOclbTIvynZf9JV+fqZtfgs/8F/Nu5rB
EIBmJ+8QRMmpU7EzGRsf2FzuePqYRbzh/zE26EwdrT10f6r6o8HOYzCJB9Dpff8tbnGLG8L/A/WE
roTBs2RqAAAAAElFTkSuQmCC'
     style='height:25px; border-radius:12px; display: inline-block; float: left; vertical-align: middle'></img>


  <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAjCAYAAAAe2bNZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAK6wAACusBgosNWgAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAf9SURBVFiFvZh7cFTVHcc/59y7793sJiFAwkvAYDRqFWwdraLVlj61diRYsDjqCFbFKrYo0CltlSq1tLaC2GprGIriGwqjFu10OlrGv8RiK/IICYECSWBDkt3s695zTv9IAtlHeOn0O7Mzu797z+/3Ob/z+p0VfBq9doNFljuABwAXw2PcvGHt6bgwxhz7Ls4YZNVXxxANLENwE2D1W9PAGmAhszZ0/X9gll5yCbHoOirLzmaQs0F6F8QMZq1v/8xgNm7DYwwjgXJLYL4witQ16+sv/U9HdDmV4WrKw6B06cZC/RMrM4MZ7xz61DAbtzEXmAvUAX4pMOVecg9/MFFu3j3Gz7gQBLygS2RGumBkL0cubiFRsR3LzVBV1UMk3IrW73PT9C2lYOwhQB4ClhX1AuKpjLcV27oEjyUpNUJCg1CvcejykWTCXyQgzic2HIIBjg3pS6+uRLKAhumZvD4U+tq0jTrgkVKQQtLekfTtxIPAkhTNF6G7kZm7aPp6M9myKVQEoaYaIhEQYvD781DML/RfBGNZXAl4irJiwBa07e/y7cQnBaJghIX6ENl2GR/fGCBoz6cm5qeyEqQA5ZYA5x5eeiV0Qph4gjFAUSwAr6QllQgcxS/Jm25Cr2Tmpsk03XI9NfI31FTZBEOgVOk51adqDBNPCNPSRlkiDXbBEwOU2WxH+I7itQZ62g56OjM33suq1YsZHVtGZSUI2QdyYgkgOthQNIF7BIGDnRAJgJSgj69cUx1gB8PkOGwL4E1gPrM27gIg7NlGKLQApc7BmEnAxP5g/rw4YqBrCDB5xHkw5rdR/1qTrN/hKNo6YUwVDNpFsnjYS8RbidBPcPXFP6R6yfExuOXmN4A3jv1+8ZUwgY9D2OWjUZE6lO88jDwHI8ZixGiMKSeYTBamCoDk6kDAb6y1OcH1a6KpD/fZesoFw5FlIXAVCIiH4PxrV+p2npVDToTBmtjY8t1swh2V61E9KqWiyuPEjM8dbfxuvfa49Zayf9R136Wr8mBSf/T7bNteA8zwaGEUbFpckWwq95n59dUIywKl2fbOIS5e8bWSu0tJ1a5redAYfqkdjesodFajcgaVNWhXo1C9SrkN3Usmv3UMJrc6/DDwkwEntkEJLe67tSLhvyzK8rHDQWleve5CGk4VZEB1r+5bg2E2si+Y0QatDK6jUVkX5eg2YYlp++ZM+rfMNYamAj8Y7MAVWFqaR1f/t2xzU4IHjybBtthzuiAASqv7jTF7jOqDMAakFHgDNsFyP+FhwZHBmH9F7cutIYkQCylYYv1AZSqsn1/+bX51OMMjPSl2nAnM7hnjOx2v53YgNWAzHM9Q/9l0lQWPSCBSyokAtOBC1Rj+w/1Xs+STDp4/E5g7Rs2zm2+oeVd7PUuHKDf6A4r5EsPT5K3gfCnBXNUYnvGzb+KcCczYYWOnLpy4eOXuG2oec0PBN8XQQAnpvS35AvAykr56rWhPBiV4MvtceGLxk5Mr6A1O8IfK7rl7xJ0r9kyumuP4fa0lMqTBLJIAJqEf1J3qE92lMBndlyfRD2YBghHC4hlny7ASqCeWo5zaoDdIWfnIefNGTb9fC73QDfhyBUCNOxrGPSUBfPem9us253YTV+3mcBbdkUYfzmHiLqZbYdIGHHON2ZlemXouaJUOO6TqtdHEQuXYY8Yt+EbDgmlS6RdzkaDTv2P9A3gICiq93sWhb5mc5wVhuU3Y7m5hOc3So7qFT3SLgOXHb/cyOfMn7xROegoC/PTcn3v8gbKPgDopJFk3R/uBPWQiwQ+2/GJevRMObLUzqe/saJjQUQTTftEVMW9tWxPgAocwcj9abNcZe7s+6t2R2xXZG7zyYLp8Q1PiRBBHym5bYuXi8Qt+/LvGu9f/5YDAxABsaRNPH6Xr4D4Sk87a897SOy9v/fKwjoF2eQel95yDESGEF6gEMwKhLwKus3wOVjTtes7qzgLdXTMnNCNoEpbcrtNuq6N7Xh/+eqcbj94xQkp7mdKpW5XbtbR8Z26kgMCAf2UU5YEovRUVRHbu2b3vK1UdDFkDCyMRQxbpdv8nhKAGIa7QaQedzT07fFPny53R738JoVYBdVrnsNx9XZ9v33UeGO+AA2MMUkgqQ5UcdDLZSFeVgONnXeHqSAC5Ew1BXwko0D1Zct3dT1duOjS3MzZnEUJtBuoQAq3SGOLR4ekjn9NC5nVOaYXf9lETrUkmOJy3pOz8OKIb2A1cWhJCCEzOxU2mUPror+2/L3yyM3pkM7jTjr1nBOgkGeyQ7erxpdJsMAS9wb2F9rzMxNY1K2PMU0WtZV82VU8Wp6vbKJVo9Lx/+4cydORdxCCQ/kDGTZCWsRpLu7VD7bfKqL8V2orKTp/PtzaXy42jr6TwAuisi+7JolUG4wY+8vyrISCMtRrLKWpvjAOqx/QGhp0rjRo5xD3x98CWQuOQN8qumRMmI7jKZPUEpzNVZsj4Zbaq1to5tZZsKIydLWojhIXrJnES79EaOzv3du2NytKuxzJKAA6wF8xqEE8s2jo/1wd/khslQGxd81Zg62Bbp31XBH+iETt7Y3ELA0iU6iGDlQ5mexe0VEx4a3x8V1AaYwFJgTiwaOsDmeK2J8nMUOqsnB1A+dcA04ucCYt0urkjmflk9iT2v30q/gZn5rQPvor4n9Ou634PeBzoznes/iot/7WnClKoM/+zCIjH5kwT8ChQjTHPIPTjFV3PpU/Hx+DM/A9U3IXI4SPCYAAAAABJRU5ErkJggg=='
       style='height:15px; border-radius:12px; display: inline-block; float: left'></img>





</div><div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">hv_image</span> <span class="o">=</span> <span class="n">hv</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">hFacC</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;THETA&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">hv</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="s1">&#39;YC&#39;</span><span class="p">],</span> <span class="n">dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">with</span> <span class="n">dask</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;single-threaded&#39;</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">regrid</span><span class="p">(</span><span class="n">hv_image</span><span class="p">,</span> <span class="n">precompute</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="hololayout row row-fluid">
  <div class="holoframe" id="display_areac463062919f34a67bf0f1bcc898ffe21">
    <div id="_anim_imgc463062919f34a67bf0f1bcc898ffe21">

      <div id='655b9cd4-6c23-4ade-8480-06c0ca88f66a' style='display: table; margin: 0 auto;'>
<div class="bk-root">
    <div class="bk-plotdiv" id="553601ef-8db5-4e84-8e71-efabf9e093a6"></div>
</div></div>

    </div>
  </div>
  <div class="holowidgets" id="widget_areac463062919f34a67bf0f1bcc898ffe21">
    <form class="holoform well" id="formc463062919f34a67bf0f1bcc898ffe21">


      <div class="form-group control-group holoformgroup" style=''>
        <label for="textInputc463062919f34a67bf0f1bcc898ffe21_vertical_coordinate_of_cell_center_left_parenthesis_m_right_parenthesis">
          <strong>vertical coordinate of cell center (m):</strong>
        </label>
        <div class="holowell">
          <div class="hologroup">
            <input type="text" class="holotext form-control input-small"
                   id="textInputc463062919f34a67bf0f1bcc898ffe21_vertical_coordinate_of_cell_center_left_parenthesis_m_right_parenthesis" value="" readonly>
          </div>
          <div class="holoslider"
               id="_anim_widgetc463062919f34a67bf0f1bcc898ffe21_vertical_coordinate_of_cell_center_left_parenthesis_m_right_parenthesis"></div>
        </div>
      </div>



      <div class="form-group control-group holoformgroup" style=''>
        <label for="textInputc463062919f34a67bf0f1bcc898ffe21_Time">
          <strong>Time:</strong>
        </label>
        <div class="holowell">
          <div class="hologroup">
            <input type="text" class="holotext form-control input-small"
                   id="textInputc463062919f34a67bf0f1bcc898ffe21_Time" value="" readonly>
          </div>
          <div class="holoslider"
               id="_anim_widgetc463062919f34a67bf0f1bcc898ffe21_Time"></div>
        </div>
      </div>


        </form>
    </div>
</div></div>
<div class="section" id="create-xgcm-grid">
<h2>Create xgcm grid<a class="headerlink" href="#create-xgcm-grid" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://xgcm.readthedocs.io">Xgcm</a> is a package which helps with the
analysis of GCM data.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xgcm</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">xgcm</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">))</span>
<span class="n">grid</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xgcm</span><span class="o">.</span><span class="n">Grid</span><span class="o">&gt;</span>
<span class="n">Y</span> <span class="n">Axis</span> <span class="p">(</span><span class="n">periodic</span><span class="p">):</span>
  <span class="o">*</span> <span class="n">center</span>   <span class="n">YC</span> <span class="p">(</span><span class="mi">320</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">left</span>
  <span class="o">*</span> <span class="n">left</span>     <span class="n">YG</span> <span class="p">(</span><span class="mi">320</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">center</span>
<span class="n">X</span> <span class="n">Axis</span> <span class="p">(</span><span class="n">periodic</span><span class="p">):</span>
  <span class="o">*</span> <span class="n">center</span>   <span class="n">XC</span> <span class="p">(</span><span class="mi">2160</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">left</span>
  <span class="o">*</span> <span class="n">left</span>     <span class="n">XG</span> <span class="p">(</span><span class="mi">2160</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">center</span>
<span class="n">T</span> <span class="n">Axis</span> <span class="p">(</span><span class="ow">not</span> <span class="n">periodic</span><span class="p">):</span>
  <span class="o">*</span> <span class="n">center</span>   <span class="n">time</span> <span class="p">(</span><span class="mi">438</span><span class="p">)</span>
<span class="n">Z</span> <span class="n">Axis</span> <span class="p">(</span><span class="ow">not</span> <span class="n">periodic</span><span class="p">):</span>
  <span class="o">*</span> <span class="n">center</span>   <span class="n">Z</span> <span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">left</span>
  <span class="o">*</span> <span class="n">left</span>     <span class="n">Zl</span> <span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">center</span>
  <span class="o">*</span> <span class="n">outer</span>    <span class="n">Zp1</span> <span class="p">(</span><span class="mi">43</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">center</span>
  <span class="o">*</span> <span class="n">right</span>    <span class="n">Zu</span> <span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="o">--&gt;</span> <span class="n">center</span>
</pre></div>
</div>
</div>
<div class="section" id="tracer-budgets">
<h2>Tracer Budgets<a class="headerlink" href="#tracer-budgets" title="Permalink to this headline">¶</a></h2>
<p>Here we will do the heat and salt budgets for SOSE. In integral form,
these budgets can be written as</p>
<div class="math">
\[\mathcal{V} \frac{\partial S}{\partial t} = G^S_{adv} + G^S_{diff} + G^S_{surf} + G^S_{linfs}\]</div>
<div class="math">
\[\mathcal{V} \frac{\partial \theta}{\partial t} = G^\theta_{adv} + G^\theta_{diff} + G^\theta_{surf} + G^\theta_{linfs} + G^\theta_{sw}\]</div>
<p>where <span class="math">\(\mathcal{V}\)</span> is the volume of the grid cell. The terms on
the right-hand side are called <em>tendencies</em>. They add up to the total
tendency (the left hand side).</p>
<p>The first term is the convergence of advective fluxes. The second is the
convergence of diffusive fluxes. The third is the explicit surface flux.
The fourth is the correction due to the linear free-surface
approximation. The fifth is shortwave penetration (only for
temperature).</p>
<div class="section" id="flux-divergence">
<h3>Flux Divergence<a class="headerlink" href="#flux-divergence" title="Permalink to this headline">¶</a></h3>
<p>First we define a function to calculate the convergence of the advective
and diffusive fluxes, since this has to be repeated for both tracers.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tracer_flux_budget</span><span class="p">(</span><span class="n">suffix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the convergence of fluxes of tracer `suffix` where</span>
<span class="sd">    `suffix` is `TH` or `SLT`. Return a new xarray.Dataset.&quot;&quot;&quot;</span>
    <span class="n">conv_horiz_adv_flux</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;ADVx_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span> <span class="o">+</span>
                          <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;ADVy_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;Y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;conv_horiz_adv_flux_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="n">conv_horiz_diff_flux</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;DFxE_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span> <span class="o">+</span>
                          <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;DFyE_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;Y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;conv_horiz_diff_flux_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="c1"># sign convention is opposite for vertical fluxes</span>
    <span class="n">conv_vert_adv_flux</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;ADVr_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;conv_vert_adv_flux_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="n">conv_vert_diff_flux</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;DFrE_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span> <span class="o">+</span>
                           <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;DFrI_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span> <span class="o">+</span>
                           <span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;KPPg_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">],</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;conv_vert_diff_flux_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>

    <span class="n">all_fluxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">conv_horiz_adv_flux</span><span class="p">,</span> <span class="n">conv_horiz_diff_flux</span><span class="p">,</span> <span class="n">conv_vert_adv_flux</span><span class="p">,</span> <span class="n">conv_vert_diff_flux</span><span class="p">]</span>
    <span class="n">conv_all_fluxes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">all_fluxes</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;conv_total_flux_&#39;</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_fluxes</span> <span class="o">+</span> <span class="p">[</span><span class="n">conv_all_fluxes</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_slt</span> <span class="o">=</span> <span class="n">tracer_flux_budget</span><span class="p">(</span><span class="s1">&#39;SLT&#39;</span><span class="p">)</span>
<span class="n">budget_slt</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                   <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">time</span>                      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Z</span>                         <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>                        <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>                        <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_horiz_diff_flux_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_adv_flux_SLT</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_diff_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_total_flux_SLT</span>       <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_th</span> <span class="o">=</span> <span class="n">tracer_flux_budget</span><span class="p">(</span><span class="s1">&#39;TH&#39;</span><span class="p">)</span>
<span class="n">budget_th</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                  <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">time</span>                     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">Z</span>                        <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>                       <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>                       <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_horiz_diff_flux_TH</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_adv_flux_TH</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_diff_flux_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_total_flux_TH</span>       <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="surface-fluxes">
<h3>Surface Fluxes<a class="headerlink" href="#surface-fluxes" title="Permalink to this headline">¶</a></h3>
<p>The surface fluxes are only active in the top model layer. We need to
specify some constants to convert to the proper units and scale factors
to convert to integral form. They also require some xarray special sauce
to merge with the 3D variables.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># constants</span>
<span class="n">heat_capacity_cp</span> <span class="o">=</span> <span class="mf">3.994e3</span>
<span class="n">runit2mass</span> <span class="o">=</span> <span class="mf">1.035e3</span>

<span class="c1"># treat the shortwave flux separately from the rest of the surface flux</span>
<span class="n">surf_flux_th</span> <span class="o">=</span> <span class="p">(</span><span class="n">dsr</span><span class="o">.</span><span class="n">TFLUX</span> <span class="o">-</span> <span class="n">dsr</span><span class="o">.</span><span class="n">oceQsw</span><span class="p">)</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">rA</span> <span class="o">/</span> <span class="p">(</span><span class="n">heat_capacity_cp</span> <span class="o">*</span> <span class="n">runit2mass</span><span class="p">)</span>
<span class="n">surf_flux_th_sw</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">oceQsw</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">rA</span> <span class="o">/</span> <span class="p">(</span><span class="n">heat_capacity_cp</span> <span class="o">*</span> <span class="n">runit2mass</span><span class="p">)</span>

<span class="c1"># salt</span>
<span class="n">surf_flux_slt</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">SFLUX</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">rA</span>  <span class="o">/</span> <span class="n">runit2mass</span>
<span class="n">lin_fs_correction_th</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">dsr</span><span class="o">.</span><span class="n">WTHMASS</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Zl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">rA</span><span class="p">)</span>
<span class="n">lin_fs_correction_slt</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">dsr</span><span class="o">.</span><span class="n">WSLTMASS</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Zl</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">rA</span><span class="p">)</span>

<span class="c1"># in order to align the surface fluxes with the rest of the 3D budget terms,</span>
<span class="c1"># we need to give them a z coordinate. We can do that with this function</span>
<span class="k">def</span> <span class="nf">surface_to_3d</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="shortwave-flux">
<h3>Shortwave Flux<a class="headerlink" href="#shortwave-flux" title="Permalink to this headline">¶</a></h3>
<p>Special treatment is needed for the shortwave flux, which penetrates
into the interior of the water column</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">swfrac</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">fact</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">jwtype</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Clone of MITgcm routine for computing sw flux penetration.</span>
<span class="sd">    z: depth of output levels&quot;&quot;&quot;</span>

    <span class="n">rfac</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.58</span> <span class="p">,</span> <span class="mf">0.62</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">]</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.35</span> <span class="p">,</span> <span class="mf">0.6</span>  <span class="p">,</span> <span class="mf">1.0</span>  <span class="p">,</span> <span class="mf">1.5</span>  <span class="p">,</span> <span class="mf">1.4</span><span class="p">]</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">23.0</span> <span class="p">,</span> <span class="mf">20.0</span> <span class="p">,</span> <span class="mf">17.0</span> <span class="p">,</span> <span class="mf">14.0</span> <span class="p">,</span> <span class="mf">7.9</span> <span class="p">]</span>

    <span class="n">facz</span> <span class="o">=</span> <span class="n">fact</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">Zl</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Zl</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">jwtype</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">swdk</span> <span class="o">=</span> <span class="p">(</span><span class="n">rfac</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">facz</span> <span class="o">/</span> <span class="n">a1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span>
            <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rfac</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">facz</span> <span class="o">/</span> <span class="n">a2</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">swdk</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;swdk&#39;</span><span class="p">)</span>

<span class="n">_</span><span class="p">,</span> <span class="n">swdown</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">dsr</span><span class="o">.</span><span class="n">Zl</span><span class="p">,</span> <span class="n">surf_flux_th_sw</span> <span class="o">*</span> <span class="n">swfrac</span><span class="p">(</span><span class="n">coords</span><span class="p">),</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="p">)</span>
<span class="n">swdown</span> <span class="o">=</span> <span class="n">swdown</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># now we can add the to the budget datasets and they will align correctly</span>
<span class="c1"># into the top cell (lazily filling with NaN&#39;s elsewhere)</span>
<span class="n">budget_slt</span><span class="p">[</span><span class="s1">&#39;surface_flux_conv_SLT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface_to_3d</span><span class="p">(</span><span class="n">surf_flux_slt</span><span class="p">)</span>
<span class="n">budget_slt</span><span class="p">[</span><span class="s1">&#39;lin_fs_correction_SLT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface_to_3d</span><span class="p">(</span><span class="n">lin_fs_correction_slt</span><span class="p">)</span>
<span class="n">budget_slt</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                   <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">Z</span>                         <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">time</span>                      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>                        <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>                        <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_horiz_diff_flux_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_adv_flux_SLT</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_diff_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_total_flux_SLT</span>       <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surface_flux_conv_SLT</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">lin_fs_correction_SLT</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_th</span><span class="p">[</span><span class="s1">&#39;surface_flux_conv_TH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface_to_3d</span><span class="p">(</span><span class="n">surf_flux_th</span><span class="p">)</span>
<span class="n">budget_th</span><span class="p">[</span><span class="s1">&#39;lin_fs_correction_TH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface_to_3d</span><span class="p">(</span><span class="n">lin_fs_correction_th</span><span class="p">)</span>
<span class="n">budget_th</span><span class="p">[</span><span class="s1">&#39;sw_flux_conv_TH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">grid</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">swdown</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">budget_th</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                  <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">Z</span>                        <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">time</span>                     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>                       <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>                       <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_horiz_diff_flux_TH</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_adv_flux_TH</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_diff_flux_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_total_flux_TH</span>       <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surface_flux_conv_TH</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">lin_fs_correction_TH</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">sw_flux_conv_TH</span>          <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="add-it-all-up">
<h3>Add it all up<a class="headerlink" href="#add-it-all-up" title="Permalink to this headline">¶</a></h3>
<p>The total tendency should be given by</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_th</span><span class="p">[</span><span class="s1">&#39;total_tendency_TH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget_th</span><span class="o">.</span><span class="n">conv_total_flux_TH</span> <span class="o">+</span>
                                  <span class="n">budget_th</span><span class="o">.</span><span class="n">surface_flux_conv_TH</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="n">budget_th</span><span class="o">.</span><span class="n">lin_fs_correction_TH</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">+</span>
                                  <span class="n">budget_th</span><span class="o">.</span><span class="n">sw_flux_conv_TH</span><span class="p">)</span>
<span class="n">budget_th</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                  <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">Z</span>                        <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">time</span>                     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>                       <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>                       <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_horiz_diff_flux_TH</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_adv_flux_TH</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_diff_flux_TH</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_total_flux_TH</span>       <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surface_flux_conv_TH</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">lin_fs_correction_TH</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">sw_flux_conv_TH</span>          <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">total_tendency_TH</span>        <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_slt</span><span class="p">[</span><span class="s1">&#39;total_tendency_SLT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget_slt</span><span class="o">.</span><span class="n">conv_total_flux_SLT</span> <span class="o">+</span>
                                    <span class="n">budget_slt</span><span class="o">.</span><span class="n">surface_flux_conv_SLT</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">+</span>
                                    <span class="n">budget_slt</span><span class="o">.</span><span class="n">lin_fs_correction_SLT</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
<span class="n">budget_slt</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                   <span class="p">(</span><span class="n">XC</span><span class="p">:</span> <span class="mi">2160</span><span class="p">,</span> <span class="n">YC</span><span class="p">:</span> <span class="mi">320</span><span class="p">,</span> <span class="n">Z</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">Z</span>                         <span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">5.0</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">-</span><span class="mf">27.0</span> <span class="o">-</span><span class="mf">39.5</span> <span class="o">-</span><span class="mf">53.0</span> <span class="o">-</span><span class="mf">68.0</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">time</span>                      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">YC</span>                        <span class="p">(</span><span class="n">YC</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">77.87497</span> <span class="o">-</span><span class="mf">77.7083</span> <span class="o">-</span><span class="mf">77.54163</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">XC</span>                        <span class="p">(</span><span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">0.083333336</span> <span class="mf">0.25</span> <span class="mf">0.4166667</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_horiz_diff_flux_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_adv_flux_SLT</span>    <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_vert_diff_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">conv_total_flux_SLT</span>       <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">surface_flux_conv_SLT</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">lin_fs_correction_SLT</span>     <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">)</span><span class="o">&gt;</span>
    <span class="n">total_tendency_SLT</span>        <span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">YC</span><span class="p">,</span> <span class="n">XC</span><span class="p">)</span> <span class="n">float32</span> <span class="n">dask</span><span class="o">.</span><span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">438</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">2160</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">2159</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="include-the-truth">
<h3>Include the “truth”<a class="headerlink" href="#include-the-truth" title="Permalink to this headline">¶</a></h3>
<p>MITgcm keeps track of the true total tendence in the <code class="docutils literal"><span class="pre">TOT?TEND</span></code>
variables. We can use these as check on our budget calculation.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="o">=</span> <span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">drF</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">rA</span> <span class="o">*</span> <span class="n">coords</span><span class="o">.</span><span class="n">hFacC</span><span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
<span class="n">day2seconds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span><span class="o">**-</span><span class="mi">1</span>

<span class="n">budget_th</span><span class="p">[</span><span class="s1">&#39;total_tendency_TH_truth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">TOTTTEND</span> <span class="o">*</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">day2seconds</span>
<span class="n">budget_slt</span><span class="p">[</span><span class="s1">&#39;total_tendency_SLT_truth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">TOTSTEND</span> <span class="o">*</span> <span class="n">volume</span> <span class="o">*</span> <span class="n">day2seconds</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="validate-budget">
<h2>Validate Budget<a class="headerlink" href="#validate-budget" title="Permalink to this headline">¶</a></h2>
<p>Now we do some checks to verify that the budget adds up.</p>
<div class="section" id="vertical-and-horizontal-integrals-of-budget">
<h3>Vertical and Horizontal Integrals of Budget<a class="headerlink" href="#vertical-and-horizontal-integrals-of-budget" title="Permalink to this headline">¶</a></h3>
<p>We will take an average over the first 10 timesteps</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">time_slice</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">valid_range</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">check_vertical</span><span class="p">(</span><span class="n">budget</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
    <span class="n">ds_chk</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget</span><span class="p">[[</span><span class="n">f</span><span class="s1">&#39;total_tendency_</span><span class="si">{suffix}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;total_tendency_</span><span class="si">{suffix}</span><span class="s1">_truth&#39;</span><span class="p">]]</span>
              <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_range</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;XC&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ds_chk</span>

<span class="k">def</span> <span class="nf">check_horizontal</span><span class="p">(</span><span class="n">budget</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
    <span class="n">ds_chk</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget</span><span class="p">[[</span><span class="n">f</span><span class="s1">&#39;total_tendency_</span><span class="si">{suffix}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;total_tendency_</span><span class="si">{suffix}</span><span class="s1">_truth&#39;</span><span class="p">]]</span>
              <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_range</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span> <span class="s1">&#39;XC&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ds_chk</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">th_vert</span> <span class="o">=</span> <span class="n">check_vertical</span><span class="p">(</span><span class="n">budget_th</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">time_slice</span><span class="p">),</span> <span class="s1">&#39;TH&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">th_vert</span><span class="o">.</span><span class="n">total_tendency_TH</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">th_vert</span><span class="o">.</span><span class="n">total_tendency_TH_truth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7f10ba181240</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_0.png" src="../../_images/SOSE_0.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">th_horiz</span> <span class="o">=</span> <span class="n">check_horizontal</span><span class="p">(</span><span class="n">budget_th</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">time_slice</span><span class="p">),</span> <span class="s1">&#39;TH&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">th_horiz</span><span class="o">.</span><span class="n">total_tendency_TH</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="n">th_horiz</span><span class="o">.</span><span class="n">total_tendency_TH_truth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7fe85f5ba470</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_1.png" src="../../_images/SOSE_1.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">slt_vert</span> <span class="o">=</span> <span class="n">check_vertical</span><span class="p">(</span><span class="n">budget_slt</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">time_slice</span><span class="p">),</span> <span class="s1">&#39;SLT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">slt_vert</span><span class="o">.</span><span class="n">total_tendency_SLT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">slt_vert</span><span class="o">.</span><span class="n">total_tendency_SLT_truth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7f10b4ed7828</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_2.png" src="../../_images/SOSE_2.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">slt_horiz</span> <span class="o">=</span> <span class="n">check_horizontal</span><span class="p">(</span><span class="n">budget_slt</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">time_slice</span><span class="p">),</span> <span class="s1">&#39;SLT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">slt_horiz</span><span class="o">.</span><span class="n">total_tendency_SLT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="n">slt_horiz</span><span class="o">.</span><span class="n">total_tendency_SLT_truth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7f10b3622160</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_3.png" src="../../_images/SOSE_3.png" />
</div>
<div class="section" id="histogram-analysis-of-error">
<h3>Histogram Analysis of Error<a class="headerlink" href="#histogram-analysis-of-error" title="Permalink to this headline">¶</a></h3>
<p>The curves look the same. But how do we know whether our error is truly
“small”? Answer: we compare the distribution of the error</p>
<div class="math">
\[P( G_{est} - G_{truth} )\]</div>
<p>to the distribution of the other terms in the equation, e.g.
<span class="math">\(P(G_{adv})\)</span>.</p>
<p>First we try to determine the appropriate range for our histograms by
looking at the maximum values.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_th</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">time_slice</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                  <span class="p">()</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_TH</span>   <span class="n">float32</span> <span class="mf">19145940.0</span>
    <span class="n">conv_horiz_diff_flux_TH</span>  <span class="n">float32</span> <span class="mf">89941.086</span>
    <span class="n">conv_vert_adv_flux_TH</span>    <span class="n">float32</span> <span class="mf">23173650.0</span>
    <span class="n">conv_vert_diff_flux_TH</span>   <span class="n">float32</span> <span class="mf">534407.7</span>
    <span class="n">conv_total_flux_TH</span>       <span class="n">float32</span> <span class="mf">510076.62</span>
    <span class="n">surface_flux_conv_TH</span>     <span class="n">float32</span> <span class="mf">21228.941</span>
    <span class="n">lin_fs_correction_TH</span>     <span class="n">float32</span> <span class="mf">10248.496</span>
    <span class="n">sw_flux_conv_TH</span>          <span class="n">float32</span> <span class="mf">21346.447</span>
    <span class="n">total_tendency_TH</span>        <span class="n">float32</span> <span class="mf">510076.62</span>
    <span class="n">total_tendency_TH_truth</span>  <span class="n">float32</span> <span class="mf">297048.4</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_slt</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">time_slice</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                   <span class="p">()</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_SLT</span>   <span class="n">float32</span> <span class="mf">94174560.0</span>
    <span class="n">conv_horiz_diff_flux_SLT</span>  <span class="n">float32</span> <span class="mf">17939.193</span>
    <span class="n">conv_vert_adv_flux_SLT</span>    <span class="n">float32</span> <span class="mf">105942130.0</span>
    <span class="n">conv_vert_diff_flux_SLT</span>   <span class="n">float32</span> <span class="mf">76532.33</span>
    <span class="n">conv_total_flux_SLT</span>       <span class="n">float32</span> <span class="mf">5261500.5</span>
    <span class="n">surface_flux_conv_SLT</span>     <span class="n">float32</span> <span class="mf">7828.6157</span>
    <span class="n">lin_fs_correction_SLT</span>     <span class="n">float32</span> <span class="mf">20308.545</span>
    <span class="n">total_tendency_SLT</span>        <span class="n">float32</span> <span class="mf">5261500.5</span>
    <span class="n">total_tendency_SLT_truth</span>  <span class="n">float32</span> <span class="mf">46110.24</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># parameters for histogram calculation</span>
<span class="n">th_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">2e7</span><span class="p">)</span>
<span class="n">slt_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">)</span>
<span class="n">valid_region</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">))</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="mi">301</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># budget errors</span>
<span class="n">error_th</span> <span class="o">=</span> <span class="n">budget_th</span><span class="o">.</span><span class="n">total_tendency_TH</span> <span class="o">-</span> <span class="n">budget_th</span><span class="o">.</span><span class="n">total_tendency_TH_truth</span>
<span class="n">error_slt</span> <span class="o">=</span> <span class="n">budget_slt</span><span class="o">.</span><span class="n">total_tendency_SLT</span> <span class="o">-</span> <span class="n">budget_slt</span><span class="o">.</span><span class="n">total_tendency_SLT_truth</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># calculate theta error histograms over the whole time range</span>
<span class="n">adv_hist_th</span><span class="p">,</span> <span class="n">hbins_th</span> <span class="o">=</span> <span class="n">dsa</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">budget_th</span><span class="o">.</span><span class="n">conv_horiz_adv_flux_TH</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_region</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                        <span class="n">bins</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">th_range</span><span class="p">)</span>
<span class="n">err_hist_th</span><span class="p">,</span> <span class="n">hbins_th</span> <span class="o">=</span> <span class="n">dsa</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">error_th</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_region</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                        <span class="n">bins</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">th_range</span><span class="p">)</span>
<span class="n">err_hist_th</span><span class="p">,</span> <span class="n">adv_hist_th</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">err_hist_th</span><span class="p">,</span> <span class="n">adv_hist_th</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">bin_c_th</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">hbins_th</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">hbins_th</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">bin_c_th</span><span class="p">,</span> <span class="n">adv_hist_th</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Advective Tendency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">bin_c_th</span><span class="p">,</span> <span class="n">err_hist_th</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Budget Residual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;THETA Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;THETA Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_4.png" src="../../_images/SOSE_4.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="c1"># calculate salt error histograms over the whole time range</span>
<span class="n">adv_hist_slt</span><span class="p">,</span> <span class="n">hbins_slt</span> <span class="o">=</span> <span class="n">dsa</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">budget_slt</span><span class="o">.</span><span class="n">conv_horiz_adv_flux_SLT</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_region</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                        <span class="n">bins</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">slt_range</span><span class="p">)</span>
<span class="n">err_hist_slt</span><span class="p">,</span> <span class="n">hbins_slt</span> <span class="o">=</span> <span class="n">dsa</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">error_slt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">valid_region</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">9e13</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                        <span class="n">bins</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">slt_range</span><span class="p">)</span>
<span class="n">err_hist_slt</span><span class="p">,</span> <span class="n">adv_hist_slt</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">err_hist_slt</span><span class="p">,</span> <span class="n">adv_hist_slt</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">bin_c_slt</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">hbins_slt</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">hbins_slt</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">bin_c_slt</span><span class="p">,</span> <span class="n">adv_hist_slt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Advective Tendency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">bin_c_slt</span><span class="p">,</span> <span class="n">err_hist_slt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Budget Residual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SALT Budget&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7f10a8201fd0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_5.png" src="../../_images/SOSE_5.png" />
<p>These figures show that the error is extremely small compared to the
other terms in the budget.</p>
</div>
</div>
<div class="section" id="weddell-sea-budget-timeseries">
<h2>Weddell Sea Budget Timeseries<a class="headerlink" href="#weddell-sea-budget-timeseries" title="Permalink to this headline">¶</a></h2>
<p>Finally, we can do some science: compute the salinity budget for a
specific region, such as the upper Weddell Sea.</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_slt_weddell</span> <span class="o">=</span> <span class="p">(</span><span class="n">budget_slt</span>
                        <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">68</span><span class="p">),</span> <span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">290</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span> <span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">))</span>
                        <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="s1">&#39;YC&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">))</span>
                        <span class="o">.</span><span class="n">load</span><span class="p">())</span>
<span class="n">budget_slt_weddell</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
<span class="n">Dimensions</span><span class="p">:</span>                   <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">438</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">time</span>                      <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">06</span> <span class="mi">2005</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">11</span> <span class="o">...</span>
<span class="n">Data</span> <span class="n">variables</span><span class="p">:</span>
    <span class="n">conv_horiz_adv_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">43632460.0</span> <span class="o">-</span><span class="mf">36267436.0</span> <span class="o">...</span>
    <span class="n">conv_horiz_diff_flux_SLT</span>  <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">4892.9424</span> <span class="mf">6978.3486</span> <span class="mf">10441.184</span> <span class="o">...</span>
    <span class="n">conv_vert_adv_flux_SLT</span>    <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">110508056.0</span> <span class="mf">56280100.0</span> <span class="o">...</span>
    <span class="n">conv_vert_diff_flux_SLT</span>   <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">4837898.5</span> <span class="o">-</span><span class="mf">1010.3694</span> <span class="o">-</span><span class="mf">1765.5066</span> <span class="o">...</span>
    <span class="n">conv_total_flux_SLT</span>       <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">149297810.0</span> <span class="mf">20018620.0</span> <span class="o">...</span>
    <span class="n">surface_flux_conv_SLT</span>     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">8284682.0</span> <span class="o">-</span><span class="mf">3737431.2</span> <span class="o">...</span>
    <span class="n">lin_fs_correction_SLT</span>     <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="mf">149588460.0</span> <span class="o">-</span><span class="mf">17810290.0</span> <span class="o">...</span>
    <span class="n">total_tendency_SLT</span>        <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">7993949.5</span> <span class="o">-</span><span class="mf">1529094.9</span> <span class="o">...</span>
    <span class="n">total_tendency_SLT_truth</span>  <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">float32</span> <span class="o">-</span><span class="mf">7993943.5</span> <span class="o">-</span><span class="mf">1529095.6</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">budget_slt_weddell</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="n">budget_slt_weddell</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">4e7</span><span class="p">,</span> <span class="mf">4e7</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Weddell Sea Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Weddell Sea Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_6.png" src="../../_images/SOSE_6.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">budget_slt_weddell</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="n">budget_slt_weddell</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">4e6</span><span class="p">,</span> <span class="mf">4e6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Weddell Sea Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Weddell Sea Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_7.png" src="../../_images/SOSE_7.png" />
<p>These figures show that, while they advective terms are the largest ones
in the budget, the actual variability in salinity is driven primarily by
the surface fluxes.</p>
<div class="section" id="removing-climatlogy">
<h3>Removing Climatlogy<a class="headerlink" href="#removing-climatlogy" title="Permalink to this headline">¶</a></h3>
<p>The timeseries is pretty short, but nevertheless we can try to remove
the climatology to get a better idea of what drives the interannual
variability</p>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">budget_slt_weddell_mm</span> <span class="o">=</span> <span class="n">budget_slt_weddell</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">budget_slt_weddell_anom</span> <span class="o">=</span> <span class="n">budget_slt_weddell</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">budget_slt_weddell_mm</span>
</pre></div>
</div>
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">budget_slt_weddell</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="n">budget_slt_weddell_anom</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5e7</span><span class="p">,</span> <span class="mf">2.5e7</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Weddell Sea Anomaly Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Weddell Sea Anomaly Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_8.png" src="../../_images/SOSE_8.png" />
<div class="highlight-ipython3"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">budget_slt_weddell</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="n">budget_slt_weddell_anom</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">2.5e6</span><span class="p">,</span> <span class="mf">2.5e6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Weddell Sea Anomaly Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Weddell Sea Anomaly Salt Budget&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/SOSE_9.png" src="../../_images/SOSE_9.png" />
<p>The monthly anomaly is also premoninantly driven by surface forcing.</p>
<div class="sphx-glr-download docutils container">
<p><strong>Download python script:</strong> <a class="reference download internal" href="../../_downloads/SOSE.py" download=""><code class="xref download docutils literal"><span class="pre">SOSE.py</span></code></a></p>
<p><strong>Download Jupyter notebook:</strong> <a class="reference download internal" href="../../_downloads/SOSE.ipynb" download=""><code class="xref download docutils literal"><span class="pre">SOSE.ipynb</span></code></a></p>
</div>
</div>
</div>
</div>


      
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Pangeo Team.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.<br/>
    </p>
  </div>
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120544092-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120544092-1');
</script>
  </body>
</html>